import { settings } from ".";
import { Button, ErrorBoundary } from "../../components";
import { getProxyByKeys } from "@webpack";
import { IconFullProps } from "../../components/icons";

export function KeyboardSlash(props: IconFullProps) {
  return (
    <svg
      width={props.width}
      height={props.height}
      viewBox="0 0 24 24"
      className={props.className}
    >
      <path 
        fillRule="evenodd"
        clipRule="evenodd"
        fill="currentColor"
        d="M12.426 5.25783H3.00063C2.20481 5.25783 1.44159 5.57396 0.878863 6.13669C0.316136 6.69942 0 7.46264 0 8.25845V15.76C0 16.5558 0.316136 17.3191 0.878863 17.8818C1.44159 18.4445 2.20481 18.7606 3.00063 18.7606H4.63016L6.36272 15.7598C6.16197 15.7526 6.00125 15.5874 6.00125 15.3849V14.6348C6.00125 14.5353 6.04077 14.4399 6.11111 14.3696C6.18145 14.2992 6.27685 14.2597 6.37633 14.2597H7.22878L10.5054 8.5844C10.5162 8.50306 10.5534 8.42697 10.612 8.36831C10.6236 8.35671 10.6359 8.34595 10.6488 8.33606L12.426 5.25783ZM13.1555 14.2597L18.3527 5.25783H21.0044C21.8002 5.25783 22.5634 5.57396 23.1261 6.13669C23.6889 6.69942 24.005 7.46264 24.005 8.25845V15.76C24.005 16.5558 23.6889 17.3191 23.1261 17.8818C22.5634 18.4445 21.8002 18.7606 21.0044 18.7606H10.5568L11.5789 16.9903L12.2892 15.76H14.628C14.7275 15.76 14.8229 15.7205 14.8933 15.6502C14.9636 15.5798 15.0031 15.4844 15.0031 15.3849V14.6348C15.0031 14.5353 14.9636 14.4399 14.8933 14.3696C14.8229 14.2992 14.7275 14.2597 14.628 14.2597H13.1555ZM19.5041 9.38369V8.63353C19.5041 8.53405 19.5436 8.43865 19.6139 8.36831C19.6843 8.29797 19.7797 8.25845 19.8791 8.25845H20.6293C20.7288 8.25845 20.8242 8.29797 20.8945 8.36831C20.9649 8.43865 21.0044 8.53405 21.0044 8.63353V9.38369C21.0044 9.48316 20.9649 9.57857 20.8945 9.64891C20.8242 9.71925 20.7288 9.75877 20.6293 9.75877H19.8791C19.6721 9.75877 19.5041 9.59073 19.5041 9.38369ZM3.11048 11.3689C3.18082 11.2986 3.27623 11.2591 3.3757 11.2591H4.12586C4.22534 11.2591 4.32074 11.2986 4.39108 11.3689C4.46142 11.4393 4.50094 11.5347 4.50094 11.6342V12.3843C4.50094 12.4838 4.46142 12.5792 4.39108 12.6495C4.32074 12.7199 4.22534 12.7594 4.12586 12.7594H3.3757C3.16866 12.7594 3.00063 12.5914 3.00063 12.3843V11.6342C3.00063 11.5347 3.04014 11.4393 3.11048 11.3689ZM6.00125 12.3843V11.6342C6.00125 11.5347 6.04077 11.4393 6.11111 11.3689C6.18145 11.2986 6.27685 11.2591 6.37633 11.2591H7.12649C7.22596 11.2591 7.32136 11.2986 7.39171 11.3689C7.46205 11.4393 7.50156 11.5347 7.50156 11.6342V12.3843C7.50156 12.4838 7.46205 12.5792 7.39171 12.6495C7.32136 12.7199 7.22596 12.7594 7.12649 12.7594H6.37633C6.16929 12.7594 6.00125 12.5914 6.00125 12.3843ZM19.6139 11.3689C19.6843 11.2986 19.7797 11.2591 19.8791 11.2591H20.6293C20.7288 11.2591 20.8242 11.2986 20.8945 11.3689C20.9649 11.4393 21.0044 11.5347 21.0044 11.6342V12.3843C21.0044 12.4838 20.9649 12.5792 20.8945 12.6495C20.8242 12.7199 20.7288 12.7594 20.6293 12.7594H19.8791C19.6721 12.7594 19.5041 12.5914 19.5041 12.3843V11.6342C19.5041 11.5347 19.5436 11.4393 19.6139 11.3689ZM19.6139 14.3696C19.6843 14.2992 19.7797 14.2597 19.8791 14.2597H20.6293C20.7288 14.2597 20.8242 14.2992 20.8945 14.3696C20.9649 14.4399 21.0044 14.5353 21.0044 14.6348V15.3849C21.0044 15.4844 20.9649 15.5798 20.8945 15.6502C20.8242 15.7205 20.7288 15.76 20.6293 15.76H19.8791C19.6721 15.76 19.5041 15.592 19.5041 15.3849V14.6348C19.5041 14.5353 19.5436 14.4399 19.6139 14.3696ZM15.113 11.3689C15.1833 11.2986 15.2787 11.2591 15.3782 11.2591H17.6287C17.7282 11.2591 17.8236 11.2986 17.8939 11.3689C17.9642 11.4393 18.0038 11.5347 18.0038 11.6342V12.3843C18.0038 12.4838 17.9642 12.5792 17.8939 12.6495C17.8236 12.7199 17.7282 12.7594 17.6287 12.7594H15.3782C15.1712 12.7594 15.0031 12.5914 15.0031 12.3843V11.6342C15.0031 11.5347 15.0426 11.4393 15.113 11.3689ZM16.5034 15.3849V14.6348C16.5034 14.5353 16.543 14.4399 16.6133 14.3696C16.6836 14.2992 16.779 14.2597 16.8785 14.2597H17.6287C17.7282 14.2597 17.8236 14.2992 17.8939 14.3696C17.9642 14.4399 18.0038 14.5353 18.0038 14.6348V15.3849C18.0038 15.4844 17.9642 15.5798 17.8939 15.6502C17.8236 15.7205 17.7282 15.76 17.6287 15.76H16.8785C16.6715 15.76 16.5034 15.592 16.5034 15.3849ZM16.6133 8.36831C16.6836 8.29797 16.779 8.25845 16.8785 8.25845H17.6287C17.7282 8.25845 17.8236 8.29797 17.8939 8.36831C17.9642 8.43865 18.0038 8.53405 18.0038 8.63353V9.38369C18.0038 9.48316 17.9642 9.57857 17.8939 9.64891C17.8236 9.71925 17.7282 9.75877 17.6287 9.75877H16.8785C16.6715 9.75877 16.5034 9.59073 16.5034 9.38369V8.63353C16.5034 8.53405 16.543 8.43865 16.6133 8.36831ZM7.50156 9.38369V8.63353C7.50156 8.53405 7.54108 8.43865 7.61142 8.36831C7.68176 8.29797 7.77716 8.25845 7.87664 8.25845H8.6268C8.72627 8.25845 8.82168 8.29797 8.89202 8.36831C8.96236 8.43865 9.00188 8.53405 9.00188 8.63353V9.38369C9.00188 9.48316 8.96236 9.57857 8.89202 9.64891C8.82168 9.71925 8.72627 9.75877 8.6268 9.75877H7.87664C7.6696 9.75877 7.50156 9.59073 7.50156 9.38369ZM3.11048 8.36831C3.18082 8.29797 3.27623 8.25845 3.3757 8.25845H5.62617C5.72565 8.25845 5.82105 8.29797 5.89139 8.36831C5.96173 8.43865 6.00125 8.53405 6.00125 8.63353V9.38369C6.00125 9.48316 5.96173 9.57857 5.89139 9.64891C5.82105 9.71925 5.72565 9.75877 5.62617 9.75877H3.3757C3.16866 9.75877 3.00063 9.59073 3.00063 9.38369V8.63353C3.00063 8.53405 3.04014 8.43865 3.11048 8.36831ZM3.00063 15.3849V14.6348C3.00063 14.5353 3.04014 14.4399 3.11048 14.3696C3.18082 14.2992 3.27623 14.2597 3.3757 14.2597H4.12586C4.22534 14.2597 4.32074 14.2992 4.39108 14.3696C4.46142 14.4399 4.50094 14.5353 4.50094 14.6348V15.3849C4.50094 15.4844 4.46142 15.5798 4.39108 15.6502C4.32074 15.7205 4.22534 15.76 4.12586 15.76H3.3757C3.16866 15.76 3.00063 15.592 3.00063 15.3849Z"
      />
      <path 
        fill="currentColor"
        className="vx-st-strike"
        d="M17.5611 3.16855L16.0795 2.31311L4.81056 21.8314L6.29223 22.6869L9.11697 17.8078L9.94301 16.3636L11.0611 14.4269L13.513 10.1802L17.5611 3.16855Z"
      />
    </svg>
  )
}

function KeyboardFull() {
  return (
    <svg
      width={24}
      height={24}
      viewBox="0 0 24 14"
      className="vx-st-icon"
    >
      <path 
        fill="currentColor"
        d="M0 3.25845C0 2.46264 0.316136 1.69942 0.878863 1.13669C1.44159 0.573964 2.20481 0.257828 3.00063 0.257828H21.0044C21.8002 0.257828 22.5634 0.573964 23.1261 1.13669C23.6889 1.69942 24.005 2.46264 24.005 3.25845V10.76C24.005 11.5558 23.6889 12.3191 23.1261 12.8818C22.5634 13.4445 21.8002 13.7606 21.0044 13.7606H3.00063C2.20481 13.7606 1.44159 13.4445 0.878863 12.8818C0.316136 12.3191 0 11.5558 0 10.76V3.25845ZM19.5041 3.63353V4.38369C19.5041 4.59073 19.6721 4.75877 19.8791 4.75877H20.6293C20.7288 4.75877 20.8242 4.71925 20.8945 4.64891C20.9649 4.57857 21.0044 4.48316 21.0044 4.38369V3.63353C21.0044 3.53405 20.9649 3.43865 20.8945 3.36831C20.8242 3.29797 20.7288 3.25845 20.6293 3.25845H19.8791C19.7797 3.25845 19.6843 3.29797 19.6139 3.36831C19.5436 3.43865 19.5041 3.53405 19.5041 3.63353ZM3.3757 6.25908C3.27623 6.25908 3.18082 6.2986 3.11048 6.36894C3.04014 6.43928 3.00063 6.53468 3.00063 6.63416V7.38431C3.00063 7.59136 3.16866 7.75939 3.3757 7.75939H4.12586C4.22534 7.75939 4.32074 7.71987 4.39108 7.64953C4.46142 7.57919 4.50094 7.48379 4.50094 7.38431V6.63416C4.50094 6.53468 4.46142 6.43928 4.39108 6.36894C4.32074 6.2986 4.22534 6.25908 4.12586 6.25908H3.3757ZM6.00125 6.63416V7.38431C6.00125 7.59136 6.16929 7.75939 6.37633 7.75939H7.12649C7.22596 7.75939 7.32137 7.71987 7.39171 7.64953C7.46205 7.57919 7.50156 7.48379 7.50156 7.38431V6.63416C7.50156 6.53468 7.46205 6.43928 7.39171 6.36894C7.32137 6.2986 7.22596 6.25908 7.12649 6.25908H6.37633C6.27685 6.25908 6.18145 6.2986 6.11111 6.36894C6.04077 6.43928 6.00125 6.53468 6.00125 6.63416ZM9.37695 6.25908C9.27748 6.25908 9.18207 6.2986 9.11173 6.36894C9.04139 6.43928 9.00188 6.53468 9.00188 6.63416V7.38431C9.00188 7.59136 9.16991 7.75939 9.37695 7.75939H10.1271C10.2266 7.75939 10.322 7.71987 10.3923 7.64953C10.4627 7.57919 10.5022 7.48379 10.5022 7.38431V6.63416C10.5022 6.53468 10.4627 6.43928 10.3923 6.36894C10.322 6.2986 10.2266 6.25908 10.1271 6.25908H9.37695ZM12.0025 6.63416V7.38431C12.0025 7.59136 12.1705 7.75939 12.3776 7.75939H13.1277C13.2272 7.75939 13.3226 7.71987 13.393 7.64953C13.4633 7.57919 13.5028 7.48379 13.5028 7.38431V6.63416C13.5028 6.53468 13.4633 6.43928 13.393 6.36894C13.3226 6.2986 13.2272 6.25908 13.1277 6.25908H12.3776C12.2781 6.25908 12.1827 6.2986 12.1124 6.36894C12.042 6.43928 12.0025 6.53468 12.0025 6.63416ZM19.8791 6.25908C19.7797 6.25908 19.6843 6.2986 19.6139 6.36894C19.5436 6.43928 19.5041 6.53468 19.5041 6.63416V7.38431C19.5041 7.59136 19.6721 7.75939 19.8791 7.75939H20.6293C20.7288 7.75939 20.8242 7.71987 20.8945 7.64953C20.9649 7.57919 21.0044 7.48379 21.0044 7.38431V6.63416C21.0044 6.53468 20.9649 6.43928 20.8945 6.36894C20.8242 6.2986 20.7288 6.25908 20.6293 6.25908H19.8791ZM19.8791 9.2597C19.7797 9.2597 19.6843 9.29922 19.6139 9.36956C19.5436 9.4399 19.5041 9.53531 19.5041 9.63478V10.3849C19.5041 10.592 19.6721 10.76 19.8791 10.76H20.6293C20.7288 10.76 20.8242 10.7205 20.8945 10.6502C20.9649 10.5798 21.0044 10.4844 21.0044 10.3849V9.63478C21.0044 9.53531 20.9649 9.4399 20.8945 9.36956C20.8242 9.29922 20.7288 9.2597 20.6293 9.2597H19.8791ZM15.3782 6.25908C15.2787 6.25908 15.1833 6.2986 15.113 6.36894C15.0426 6.43928 15.0031 6.53468 15.0031 6.63416V7.38431C15.0031 7.59136 15.1712 7.75939 15.3782 7.75939H17.6287C17.7282 7.75939 17.8236 7.71987 17.8939 7.64953C17.9642 7.57919 18.0038 7.48379 18.0038 7.38431V6.63416C18.0038 6.53468 17.9642 6.43928 17.8939 6.36894C17.8236 6.2986 17.7282 6.25908 17.6287 6.25908H15.3782ZM16.5034 9.63478V10.3849C16.5034 10.592 16.6715 10.76 16.8785 10.76H17.6287C17.7282 10.76 17.8236 10.7205 17.8939 10.6502C17.9642 10.5798 18.0038 10.4844 18.0038 10.3849V9.63478C18.0038 9.53531 17.9642 9.4399 17.8939 9.36956C17.8236 9.29922 17.7282 9.2597 17.6287 9.2597H16.8785C16.779 9.2597 16.6836 9.29922 16.6133 9.36956C16.543 9.4399 16.5034 9.53531 16.5034 9.63478ZM16.8785 3.25845C16.779 3.25845 16.6836 3.29797 16.6133 3.36831C16.543 3.43865 16.5034 3.53405 16.5034 3.63353V4.38369C16.5034 4.59073 16.6715 4.75877 16.8785 4.75877H17.6287C17.7282 4.75877 17.8236 4.71925 17.8939 4.64891C17.9642 4.57857 18.0038 4.48316 18.0038 4.38369V3.63353C18.0038 3.53405 17.9642 3.43865 17.8939 3.36831C17.8236 3.29797 17.7282 3.25845 17.6287 3.25845H16.8785ZM13.5028 3.63353V4.38369C13.5028 4.59073 13.6708 4.75877 13.8779 4.75877H14.628C14.7275 4.75877 14.8229 4.71925 14.8933 4.64891C14.9636 4.57857 15.0031 4.48316 15.0031 4.38369V3.63353C15.0031 3.53405 14.9636 3.43865 14.8933 3.36831C14.8229 3.29797 14.7275 3.25845 14.628 3.25845H13.8779C13.7784 3.25845 13.683 3.29797 13.6127 3.36831C13.5423 3.43865 13.5028 3.53405 13.5028 3.63353ZM10.8773 3.25845C10.7778 3.25845 10.6824 3.29797 10.612 3.36831C10.5417 3.43865 10.5022 3.53405 10.5022 3.63353V4.38369C10.5022 4.59073 10.6702 4.75877 10.8773 4.75877H11.6274C11.7269 4.75877 11.8223 4.71925 11.8926 4.64891C11.963 4.57857 12.0025 4.48316 12.0025 4.38369V3.63353C12.0025 3.53405 11.963 3.43865 11.8926 3.36831C11.8223 3.29797 11.7269 3.25845 11.6274 3.25845H10.8773ZM7.50156 3.63353V4.38369C7.50156 4.59073 7.6696 4.75877 7.87664 4.75877H8.6268C8.72627 4.75877 8.82168 4.71925 8.89202 4.64891C8.96236 4.57857 9.00188 4.48316 9.00188 4.38369V3.63353C9.00188 3.53405 8.96236 3.43865 8.89202 3.36831C8.82168 3.29797 8.72627 3.25845 8.6268 3.25845H7.87664C7.77716 3.25845 7.68176 3.29797 7.61142 3.36831C7.54108 3.43865 7.50156 3.53405 7.50156 3.63353ZM3.3757 3.25845C3.27623 3.25845 3.18082 3.29797 3.11048 3.36831C3.04014 3.43865 3.00063 3.53405 3.00063 3.63353V4.38369C3.00063 4.59073 3.16866 4.75877 3.3757 4.75877H5.62617C5.72565 4.75877 5.82105 4.71925 5.89139 4.64891C5.96173 4.57857 6.00125 4.48316 6.00125 4.38369V3.63353C6.00125 3.53405 5.96173 3.43865 5.89139 3.36831C5.82105 3.29797 5.72565 3.25845 5.62617 3.25845H3.3757ZM3.00063 9.63478V10.3849C3.00063 10.592 3.16866 10.76 3.3757 10.76H4.12586C4.22534 10.76 4.32074 10.7205 4.39108 10.6502C4.46142 10.5798 4.50094 10.4844 4.50094 10.3849V9.63478C4.50094 9.53531 4.46142 9.4399 4.39108 9.36956C4.32074 9.29922 4.22534 9.2597 4.12586 9.2597H3.3757C3.27623 9.2597 3.18082 9.29922 3.11048 9.36956C3.04014 9.4399 3.00063 9.53531 3.00063 9.63478ZM6.37633 9.2597C6.27685 9.2597 6.18145 9.29922 6.11111 9.36956C6.04077 9.4399 6.00125 9.53531 6.00125 9.63478V10.3849C6.00125 10.592 6.16929 10.76 6.37633 10.76H14.628C14.7275 10.76 14.8229 10.7205 14.8933 10.6502C14.9636 10.5798 15.0031 10.4844 15.0031 10.3849V9.63478C15.0031 9.53531 14.9636 9.4399 14.8933 9.36956C14.8229 9.29922 14.7275 9.2597 14.628 9.2597H6.37633Z"
      />
    </svg>
  )
}

export const buttonClasses = getProxyByKeys<Record<string, string>>([ "buttonWrapper", "pulseButton" ]);

export function KeyboardButton() {
  const shouldShowTyping = settings.shouldShowTyping.use();

  return (
    <ErrorBoundary>
      <div
        className="vx-textarea-button-container"
        onClick={() => {
          settings.shouldShowTyping.set(!shouldShowTyping);
        }}
      >
        <Button
          look={Button.Looks.BLANK}
          size={Button.Sizes.NONE}
          className={buttonClasses.active}
          innerClassName="vx-textarea-button-inner"
          // @ts-expect-error idk the typings for this, so
          focusProps={{
            offset: {
              top: 4,
              bottom: 4
            }
          }}
        >
          {shouldShowTyping ? <KeyboardFull /> : <KeyboardSlash width={24} height={24} className="vx-st-icon" />}
        </Button>
      </div>
    </ErrorBoundary>
  )
}